Analysis of  **test.pcap**. 
Tools requires : **Wireshark**
# flag questions
- **Flag 1:** What is the URL accessed by the infected user that returned a 200 OK response code.

- **Flag 2:** What is the IP address, MAC address of the infected Windows client?

- **Flag 3:** Which Wireshark filter can you use to determine the victim’s hostname from NetBIOS Name Service traffic, and what is the detected hostname for this malware infection?

- **Flag 4:** Which user got infected and ran the mystery_file.ps1 PowerShell script?

- **Flag 5:** What User-Agent string indicates the traffic generated by a PowerShell script?

- **Flag 6:** Which wallet extension ID is associated with the Coinbase wallet?

# Enumeration
## flag 1
``` shell
# filter
$ http.response.code == 200
-> http://623start.site/?status=start&av=Windows%20Defender

```
*Screenshot*
![[Screenshot From 2025-05-13 08-38-18.png]]
-> `623start.site`

## flag 2
```shell
# filter
$ http
# for ip 
Internet Protocol Version 4, Src: 10.7.10.47, Dst: 195.161.114.3
# for mac
Ethernet II, Src: 80:86:5b:ab:1e:c4 (80:86:5b:ab:1e:c4), Dst: Cisco_98:ad:54 (00:b0:64:98:ad:54)

-> 10.7.10.47, 80:86:5b:ab:1e:c4
```

*Screenshot*
![[Screenshot From 2025-05-13 08-57-45.png]]

## flag3
```shell
# filter
$ nbns && nbns.flags.response == 0 'or' nbns

-> DESKTOP-9PEA63H<00> (Workstation/Redirector)
-> nbns, DESKTOP-9PEA63H
```

*Screenshot*![[Screenshot From 2025-05-13 09-20-00.png]]
## flag 4
```shell
# filter
# find a packet > packet bytes >narrow & wide > string :: enter
#--> for script follow > tcp stream 
-> rwalters
```

*Screenshot*
![[Screenshot From 2025-05-13 09-53-35.png]]
*ps script*
![[Screenshot From 2025-05-13 09-52-56.png]]
## flag 5
```shell
#filter
# same as flag 4 just change to script.ps1 to PowerShell
# follow > tcp stream
-> WindowsPowerShell
```

## flag 6
```shell
- cat powershell | grep -C10 Coinbase
	hnfanknocfeofbddgcijnmhnfnkdnaad|Coinbase
```
