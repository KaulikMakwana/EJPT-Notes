# Target Info
*IP*: `192.211.162.3`
*Domain*: `target.ine.local`
# flags
1) FLAG1{27dd0897966a41c4b85d159243ae46f7}
2) FLAG2{1ee1686bfcc3463c994d7079788f52da}
3) FLAG3{d0c29c4bad014f62936d5e3b254e4a21 }
4) FLAG4{5567819e67084c82a65ff6036cc1cdef}
# Enumerating
## Nmap Scan
### *Host Discovery*
``` shell
$ ip a s
- 192.211.162.2/24
$ nmap -sn 192.211.162.1/24
- Nmap scan report for target.ine.local (192.211.162.3)
```
### *Port Scan*

``` shell
$ sudo nmap --min-rate 10000 -p- -sV target.ine.local

-	Starting Nmap 7.92 ( https://nmap.org ) at 2025-05-12 22:37 IST
	Nmap scan report for target.ine.local (192.211.162.3)
	Host is up (0.000023s latency).
	Not shown: 65533 closed tcp ports (reset)
	
	PORT     STATE SERVICE VERSION
	80/tcp   open  http    Apache httpd 2.4.7 ((Ubuntu))
	3306/tcp open  mysql   MySQL 5.5.47-0ubuntu0.14.04.1
	MAC Address: 02:42:C0:D3:A2:03 (Unknown)
```
### *Service Scan*

```shell
$ sudo nmap -sS -sV -p80,3306 -A -T4 target.ine.local
	
-	PORT     STATE SERVICE VERSION
	# http 
	80/tcp   open  http    Apache httpd 2.4.7 ((Ubuntu))
	|_http-server-header: Apache/2.4.7 (Ubuntu)
	| http-cookie-flags: 
	|   /: 
	|     PHPSESSID: 
	|_      httponly flag not set
	| http-git: 
	|   192.211.162.3:80/.git/
	|     Git repository found!
	|     Repository description: Unnamed repository; edit this file      'description' to name the...
	|     Remotes:
	|_      https://github.com/fermayo/hello-world-lamp.git
	|_http-title: Site doesn't have a title (text/html).
	| http-robots.txt: 8 disallowed entries 
	| passwords/ config.inc classes/ javascript/ 
	|_owasp-esapi-php/ documentation/ phpmyadmin/ includes/
	# mysql
	3306/tcp open  mysql   MySQL 5.5.47-0ubuntu0.14.04.1
	| mysql-info: 
	|   Protocol: 10
	|   Version: 5.5.47-0ubuntu0.14.04.1
	|   Thread ID: 29
	|   Capabilities flags: 63487
	|   Some Capabilities: FoundRows, ODBCClient, Speaks41ProtocolOld, InteractiveClient, SupportsTransactions, IgnoreSigpipes, SupportsCompression, SupportsLoadDataLocal, DontAllowDatabaseTableColumn, ConnectWithDatabase, LongPassword, LongColumnFlag, Support41Auth, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, SupportsMultipleStatments, SupportsMultipleResults, SupportsAuthPlugins
	|   Status: Autocommit
	|   Salt: L=)VU)jZgu8T}:I@ExMX
	|_  Auth Plugin Name: mysql_native_password
	
	MAC Address: 02:42:C0:D3:A2:03 (Unknown)
	Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
	Device type: general purpose
	Running: Linux 4.X|5.X
	OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
	OS details: Linux 4.15 - 5.6
	Network Distance: 1 hop
	
	TRACEROUTE
	HOP RTT     ADDRESS
	1   0.08 ms target.ine.local (192.211.162.3)
```
## Web Enumeration
### *robots.txt*
```shell
$ curl http://target.ine.local/robots.txt # or you can browse
	
	User-agent: *
	Disallow: passwords/
	Disallow: config.inc
	Disallow: classes/
	Disallow: javascript/
	Disallow: owasp-esapi-php/
	Disallow: documentation/
	Disallow: phpmyadmin/
	Disallow: includes/

# passwords
$ curl http://target.ine.local/passwords
- 	accounts.txt
	flag.txt   # flag4

# accounts.txt
$ curl http://target.ine.local/passwords/accounts.txt
	1,admin,adminpass,g0t r00t?,Admin
	2,adrian,somepassword,Zombie Films Rock!,Admin
	3,john,monkey,I like the smell of confunk,Admin
	4,jeremy,password,d1373 1337 speak,Admin
	5,bryce,password,I Love SANS,Admin
	6,samurai,samurai,Carving fools,Admin
	7,jim,password,Rome is burning,Admin
	8,bobby,password,Hank is my dad,Admin
	9,simba,password,I am a super-cat,Admin
	10,dreveil,password,Preparation H,Admin
	11,scotty,password,Scotty do,Admin
	12,cal,password,C-A-T-S Cats Cats Cats,Admin
	13,john,password,Do the Duggie!,Admin
	14,kevin,42,Doug Adams rocks,Admin
	15,dave,set,Bet on S.E.T. FTW,Admin
	16,patches,tortoise,meow,Admin
	17,rocky,stripes,treats?,Admin
	18,tim,lanmaster53,Because reconnaissance is hard to spell,Admin
	19,ABaker,SoSecret,Muffin tops only,Admin
	20,PPan,NotTelling,Where is Tinker?,Admin
	21,CHook,JollyRoger,Gator-hater,Admin
	22,james,i<3devs,Occupation: Researcher,Admin
	23,ed,pentest,Commandline KungFu anyone?,Admin
-------------------------------------------------------------------
```
### *Dir Enum*
```shell
$ dirsearch -u http://target.ine.local/ -t 10 -o dir_enum
#  `200 OK`
	/.git/
	/.git/branches/
	/.git/config
	/.git/description
	/.git/HEAD
	/.git/hooks/
	/.git/index
	/.git/info/
	/.git/info/exclude
	/.git/logs/
	/.git/logs/HEAD
	/.git/logs/refs/heads/master
	/.git/logs/refs/remotes/origin/HEAD
	/.git/packed-refs
	/.git/refs/
	/.git/refs/heads/master
	/.git/refs/remotes/origin/HEAD
	/.git/objects/
	
	/LICENSE
	/README.md
	
	/classes/
	/config/
	/data/
	/documentation/
	/images/
	/includes/
	/index.php
	/index.php/login/
	/installation.php
	
	/passwords/
	/phpmyadmin/
	/phpmyadmin/index.php
	/phpmyadmin/README
	/phpmyadmin/ChangeLog
	
	/phpinfo.php
	/robots.txt
	/styles/
	/test/

	# 403 Forbidden or 500 Error
	/.htaccess* variations
	/.htpasswd* variations
	/.ht_wsr.txt
	/.httr-oauth
	/.php, /.php3
	/.html, /.htm
	
	/cgi-bin/
	/cgi-bin/a1stats/a1disp.cgi
	/cgi-bin/awstats/
	cgi-bin/login*
	/cgi-bin/php.ini
	/cgi-bin/test*
	/cgi-bin/ViewLog.asp
	
	/home.php (500)
	/login.php (500)
	/register.php (500)
	/server-status/

	# 301
	/ajax            
	/classes         
	/config           
	/data            
	/documentation   
	/images              
	/javascript     
	/passwords        
	/phpmyadmin       
	/styles           
	/test 
	/includes    

```

*Flag 1 Found via .git* -> `http://target.ine.local/.git/flag.txt`

### *phpinfo()*
```shell
curl http://target.ine.local/phpinfo.php
-> got flag3
```


# Exploitation
## Vulnerability Analysis

```shell
# nessus access
"url": 'https://localhost:8834/'
"username": admin
"password": adminpasswd
```

## Exploiting phpmyadmin
`could be access without requiring creds ! no username - password require`
```mysql

# finding FLAG keyword
# CLI SQL command

SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME 
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE COLUMN_NAME LIKE '%FLAG%';

# Found Flag 2
-> select databases mysql > secret_info > FLAG2
## CLI
use mysql;
show tables;
select * from secret_info;

```



